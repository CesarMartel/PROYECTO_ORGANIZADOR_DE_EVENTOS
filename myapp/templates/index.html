<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Registro de Evento</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/style.css' %}"/>
</head>
<body>
    <header class="site-header">
        <nav>
            <ul class="nav-list">
                <li><a href="{% url 'lista_eventos' %}">Registro</a></li> {# Asumiendo que 'registro.html' es esta misma página #}
                <li><a href="{% url 'lista_eventos' %}">Eventos</a></li> {# Ambos pueden apuntar a la misma lista #}
            </ul>
        </nav>
    </header>

    <main class="main-content">
        <div class="registro-container">
            <h1>{% if edit_mode %}Editar Evento{% else %}Registro de Evento{% endif %}</h1>
            <form class="registro-form" method="post" action="{% if edit_mode %}{% url 'editar_evento' evento_id %}{% else %}{% url 'lista_eventos' %}{% endif %}">
                {% csrf_token %} {# ¡MUY IMPORTANTE PARA LA SEGURIDAD EN DJANGO! #}

                <div class="form-group">
                    <label for="id_nombre">Nombre del Evento</label>
                    {{ form.nombre }} {# Esto renderiza el input de nombre #}
                    {% if form.nombre.errors %}<ul class="errorlist">{% for error in form.nombre.errors %}<li>{{ error }}</li>{% endfor %}</ul>{% endif %}
                </div>

                <div class="form-group">
                    <label for="id_fecha">Fecha</label>
                    {{ form.fecha }} {# Renderiza el input de fecha #}
                    {% if form.fecha.errors %}<ul class="errorlist">{% for error in form.fecha.errors %}<li>{{ error }}</li>{% endfor %}</ul>{% endif %}
                </div>

                <div class="form-group">
                    <label for="id_hora">Hora</label>
                    {{ form.hora }} {# Renderiza el input de hora #}
                    {% if form.hora.errors %}<ul class="errorlist">{% for error in form.hora.errors %}<li>{{ error }}</li>{% endfor %}</ul>{% endif %}
                </div>

                <div class="form-group">
                    <label for="id_ubicacion">Ubicación</label>
                    {{ form.ubicacion }} {# Renderiza el select de ubicación #}
                    {% if form.ubicacion.errors %}<ul class="errorlist">{% for error in form.ubicacion.errors %}<li>{{ error }}</li>{% endfor %}</ul>{% endif %}
                </div>

                <div class="form-group">
                    <label for="id_tipo">Tipo de Evento</label>
                    {{ form.tipo }} {# Renderiza el select de tipo #}
                    {% if form.tipo.errors %}<ul class="errorlist">{% for error in form.tipo.errors %}<li>{{ error }}</li>{% endfor %}</ul>{% endif %}
                </div>

                <div class="form-group">
                    <label for="id_descripcion">Descripción</label>
                    {{ form.descripcion }} {# Renderiza el textarea de descripción #}
                    {% if form.descripcion.errors %}<ul class="errorlist">{% for error in form.descripcion.errors %}<li>{{ error }}</li>{% endfor %}</ul>{% endif %}
                </div>

                <button type="submit" class="btn-submit">
                    {% if edit_mode %}Actualizar Evento{% else %}Registrar Evento{% endif %}
                </button>
            </form>
        </div>

        <div class="tabla-container">
            <h2>Eventos Registrados</h2>
            <table class="tabla-eventos">
                <thead>
                    <tr>
                        <th>Nombre</th>
                        <th>Fecha</th>
                        <th>Hora</th>
                        <th>Ubicación</th>
                        <th>Tipo</th>
                        <th>Descripción</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    {% for evento in eventos %}
                    <tr>
                        <td>{{ evento.nombre }}</td>
                        <td>{{ evento.fecha|date:"Y-m-d" }}</td> {# Formato de fecha #}
                        <td>{{ evento.hora|time:"H:i" }}</td> {# Formato de hora #}
                        <td>{{ evento.ubicacion }}</td>
                        <td>{{ evento.tipo }}</td>
                        <td>{{ evento.descripcion }}</td>
                        <td>
                            <a href="{% url 'editar_evento' evento.pk %}" class="btn-registro btn-editar">Editar</a>
                            <form action="{% url 'eliminar_evento' evento.pk %}" method="post" style="display:inline;">
                                {% csrf_token %}
                                <button type="submit" class="btn-registro btn-eliminar" onclick="return confirm('¿Estás seguro de que quieres eliminar este evento?');">Eliminar</button>
                            </form>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="7">No hay eventos registrados aún.</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </main>
</body>
</html>